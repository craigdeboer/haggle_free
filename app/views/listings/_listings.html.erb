<div class="breadcrumb">
	<%= link_to "ALL CATEGORIES", root_path %>
	<% if page_title.class != String %>
		<% if params[:category_id] %>
			<span> >> </span>
			<span><%= page_title.name.upcase %></span>
		<% else %>
			<span> >> </span>
			<%= link_to page_title.category.name.upcase, listings_path(category_id: page_title.category) %>
			<span> >> </span>
			<span><%= page_title.name.upcase %></span>
		<% end %>
	<% end %>
</div>

<h1 class="center">
	<%= page_title if page_title.class == String %>
	<%= page_title.name if page_title.class != String %>
</h2>
<%= will_paginate @listings %>
<% @listings.each do |listing| %>
	<% present listing do |listing_presenter| %>
	  <div class="listing-index-container">
			<div class="listing-image"><%= listing_presenter.thumbnail %></div>
			<div class="listing-title-container">
				<div class="listing-title"><%= listing_presenter.title %></div>
				<div class="sell-method-details">
					<ul>
						<li>
							<span class="attribute">Listing Number: </span>
							<span><%= listing.id %></span>
						</li>
						<li>
							<span class="attribute">Listing Type: </span>
							<span><%= listing.sell_method %></span>
						</li>
						<%= listing_presenter.sale_pending_message %>
						<li>
							<%= listing_presenter.bids_or_offers do |attribute_name, value| %>
								<%= attribute_name %>
								<%= value %>
							<% end %>
						</li>
						<li>
							<%= listing_presenter.reserve_or_current_price do |attribute_name, value| %>
								<%= content_tag :span, attribute_name, class: "attribute" %>
								<%= content_tag :span, value %>
							<% end %>
						</li>
						<li>
							<%= listing_presenter.end_date_or_next_price do |attribute_name, value| %>
								<%= attribute_name %>
								<%= value %>
							<% end %>
						</li>
						
					</ul>		
				</div>
	 		</div> <!-- listing-index-container -->
		 	<div class="listing-description">
		 		<%= truncate(listing.description, length: 150) %>
		 	</div> <!-- listing-description -->
		 	<div class="listing-footer">
		 		<span class="posted-by">Seller: <%= listing.user.user_name %></span>
		 		<span>Posted On: <%= listing.created_at.strftime("%A %B %d, %Y") %></span>
		 		<% if session[:user_listings] %>
			 		<span><%= listing_presenter.delete_listing %></span>
			 		<span><%= listing_presenter.edit_listing %></span>
			 		<span><%= listing_presenter.add_images %></span>
			 	<% end %>
		 	</div> <!-- listing-footer -->
	  </div>
  <% end %> <!-- presenter -->
<% end %> <!-- @listings.each -->
<div><%= will_paginate @listings %></div>
